function initUploader(){this.formData={},this.accept={},this.duplicate=!0,this.fileNumLimit=50,this.fileSizeLimit=209715200,this.init=function(){setContainer();var a=WebUploader.create({swf:_BasePath+"jslib/webuploader/Uploader.swf",server:"comm/attachment/uploader",pick:"#picker",resize:!1,formData:this.formData,accept:this.accept,fileSizeLimit:this.fileSizeLimit,duplicate:!0});a.on("fileQueued",function(b){$("#thelist").append('<div id="'+b.id+'" class="item">'+'<h4 class="info">'+b.name+"</h4>"+'<p class="state">等待上传...</p>'+"</div>"),a.upload()}),a.on("uploadProgress",function(a,b){var c=$("#"+a.id),d=c.find(".progress .progress-bar");d.length||(d=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(c).find(".progress-bar")),c.find("p.state").text("上传中"),d.css("width",100*b+"%")}),a.on("uploadSuccess",function(a,b){$("#"+a.id).remove(),onUploadSucess&&onUploadSucess(a,b)}),a.on("uploadError",function(a){$("#"+a.id).find("p.state").text("上传出错")}),a.on("uploadComplete",function(a){$("#"+a.id).find(".progress").fadeOut()}),$("#ctlBtn").on("click",function(){a.upload()})}}function setContainer(){var a='<div id="uploader" class="wu-example">';a+='<div id="thelist" class="uploader-list"></div>',a+='<div class="btns" style="display:none;">',a+='<div id="picker">选择文件</div>',a+='<button id="ctlBtn" class="btn btn-default">开始上传</button>',a+="</div></div>",$(document.body).before(a)}var UPLOADER;$(function(){UPLOADER=new initUploader});